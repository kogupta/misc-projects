<?xml version="1.0"?>

<cache-config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xmlns="http://xmlns.oracle.com/coherence/coherence-cache-config"
              xsi:schemaLocation="http://xmlns.oracle.com/coherence/coherence-cache-config
   coherence-cache-config.xsd">
  <caching-scheme-mapping>
    <cache-mapping>
      <cache-name>hello-example</cache-name>
      <scheme-name>distributed</scheme-name>
    </cache-mapping>
    <cache-mapping>
      <cache-name>tasks</cache-name>
      <scheme-name>replicated</scheme-name>
      <key-type>java.lang.String</key-type>
      <value-type>java.lang.String</value-type>
      <interceptors>
        <interceptor>
          <name>TaskLoader</name>
          <instance>
            <class-name>org.kogu.workerCluster.TaskLoader</class-name>
          </instance>
        </interceptor>
      </interceptors>
    </cache-mapping>
    <cache-mapping>
      <cache-name>workers</cache-name>
      <scheme-name>replicated-with-callback</scheme-name>
      <key-type>java.lang.String</key-type>
      <value-type>java.lang.String</value-type>
    </cache-mapping>
    <cache-mapping>
      <cache-name>worker-task-mapping</cache-name>
      <scheme-name>replicated</scheme-name>
      <key-type>java.lang.String</key-type>
      <value-type>java.lang.String</value-type>
    </cache-mapping>
  </caching-scheme-mapping>

  <!-- TODO: callback on cluster membership  -->

  <!--  task: load  -->
  <!--  node: capacity -->


  <caching-schemes>
    <distributed-scheme>
      <scheme-name>distributed</scheme-name>
      <service-name>DistributedCache</service-name>
      <backing-map-scheme>
        <local-scheme/>
      </backing-map-scheme>
      <autostart>true</autostart>
    </distributed-scheme>
    <replicated-scheme>
      <scheme-name>replicated</scheme-name>
      <service-name>ReplicatedCache</service-name>
      <backing-map-scheme>
        <local-scheme>
          <scheme-name>local</scheme-name>
        </local-scheme>
      </backing-map-scheme>
    </replicated-scheme>
    <replicated-scheme>
      <scheme-name>replicated-with-callback</scheme-name>
      <service-name>ReplicatedCache</service-name>
      <member-listener>
        <class-name>org.kogu.workerCluster.WorkerListener</class-name>
      </member-listener>
      <backing-map-scheme>
        <local-scheme>
          <scheme-name>local</scheme-name>
        </local-scheme>
      </backing-map-scheme>
    </replicated-scheme>
  </caching-schemes>
</cache-config>